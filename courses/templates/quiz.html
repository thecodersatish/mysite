{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Meta -->
    <meta name="description" content="">
    <meta name="author" content="Themepixels">

    <!-- Favicon -->
    <!-- <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.png"> -->

    <title>Quiz</title>

    <!-- Vendor CSS -->
    <link href="{% static 'commom/lib/remixicon/fonts/remixicon.css' %}" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Template CSS -->
    <link rel="stylesheet" href="{% static 'common/assets/css/style.css' %}">
    <link rel="stylesheet" href="{% static '/assets/css/quiz.css' %}">
  </head>
  <body class="animate bg-white">

    <div class="sidebar">
      <div class="sidebar-header">
        <a href="#" class="sidebar-logo"><span></span></a>
        <a href="#" class="sidebar-logo-text text-blue">Code<span>Hub</span></a>
      </div><!-- sidebar-header -->
      <div class="sidebar-body">
        <nav class="nav-sidebar">
          {% for q in questions %}
          {% if q.code == question.code %}
          <a href="{{q.code}}" class="text-blue">
            <div class="container d-flex flex-row justify-content-between" style="font-size: 17px;display: flex;
            justify-content: center;
            align-items: center;height: 50px;
            background-color: #f0f0f0;">
              <div>{{forloop.counter}}</div>
              <div id="status">
              {% if q.status %}
              <i class="fa fa-check" style="color: #2b6780;"></i>
              {% endif %}
              {% if q.status == False %}
              <i class="fa fa-remove" style="color: #2b6780"></i>
              {% endif %}
              </div>
              <div class="question">{{q.question}}</div>
            </div>
          </a>
          {% endif %}
          {% if q.code != question.code %}
          <a href="{{q.code}}" class="link-secondary">
            <div class="container d-flex flex-row justify-content-between" style="font-size: 17px;display: flex;
            justify-content: center;
            align-items: center;height: 50px;">
              <div>{{forloop.counter}}</div>
              {% if q.status %}
              <i class="fa fa-check" style="color: green;"></i>
              {% endif %}
              {% if q.status == False %}
              <i class="fa fa-remove" style="color: red;"></i>
              {% endif %}
              <div class="question">{{q.question}}</div>
            </div>
          </a>
          {% endif %}
          {% endfor %}
        </nav>
      </div><!-- sidebar-body -->
    </div><!-- sidebar -->

    <div class="content">
      <div class="content-header navbar navbar-expand-lg navbar-dark fixed-top">
          <button class="btn content-menu d-lg-none"><i class="fa fa-bars text-white" id="mobileMenu" style="font-size: 25px;"></i></button>
          <a class="navbar-brand d-none d-lg-flex" href="{% url 'dashboard' %}">Dashboard</a>
          <a class="navbar-brand d-lg-none" href="{% url 'dashboard' %}"><i class="fa fa-home" style="font-size: 25px;"></i></a>
        </div><!-- content-header -->
      <div class="container-fluid">
        <a href="/courses/{{question.course}}/overview" class="text-blue"><span style="font-size: 16px;"><i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Course details</span></a>
        <br>
        <br>
        <h4>Q. {{question.question |safe}}</h4>
        {% if question.has_script %}
        <div style="padding-top: 10px;">
        <pre>{{ question.script }}</pre>
        </div>
        {% endif %}
        <div class="row gy-3" style="padding-top: 10px;font-size: 18px;">
          <div> 
          <label class="form-check-label radiocontainer" for="a">
            <input class="form-check-input" type="radio" name="questionradio" value="a" id="a">
            <span style="padding-left: 3px;">{{ question.choice1|linebreaksbr }}</span><span name="questionspan" id="a" class="answer_status"></span>
          </label>
          <div>
            <div>
              <label class="form-check-label radiocontainer" for="b">
                <input class="form-check-input" type="radio" name="questionradio" value="b" id="b">
                <span style="padding-left: 3px;">{{ question.choice2|linebreaksbr }}</span><span name="questionspan" id="b" class="answer_status"></span>
              </label>
            </div>
            <div>
              <label class="form-check-label radiocontainer" for="c">
                <input class="form-check-input" type="radio" name="questionradio" value="c" id="c">
                <span style="padding-left: 3px;">{{ question.choice3|linebreaksbr }}</span></span><span name="questionspan" id="c" class="answer_status"></span>
              </label>
            </div>
            <div>
              <label class="form-check-label radiocontainer" for="d">
                <input class="form-check-input" type="radio" name="questionradio" value="d" id="d">
                <span style="padding-left: 3px;">{{ question.choice4|linebreaksbr }}</span><span name="questionspan" id="d" class="answer_status"></span>
              </label>
            </div>
          </div>
          <div id="error" style="color: red;"></div>
          <br>
          {% if question.status %}
          <button class="btn btn-success" disabled>Accepted</button>
          {% else %}
          <button class="btn btn-primary" onclick="submit()" id="quizsubmit">Submit</button>
          {% endif %}
          <br>
          <br>
          <footer>
            <button type="button" class="btn btn-outline-blue">Prev</button><span style="padding-right: 50px;"></span><button class="btn btn-outline-blue">Next</button>
          </footer>
        </div><!-- content-body -->
    </div><!-- content -->
    <script src="{% static 'common/lib/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'common/lib/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'common/lib/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
    <script src="{% static 'common/lib/feathericons/feather.min.js' %}"></script>
    <script src="{% static 'common/assets/js/script.js' %}"></script>
    <script>
      $(function(){
if('{{question.status}}'=='True'){
    $('input[id="{{question.option_selected}}"]').prop("checked", true);
    $('span[id="{{question.option_selected}}"]').html('correct answer');
    $('input[name="questionradio"]').attr("disabled",true);
}else if('{{question.status}}'=='False'){
    $('input[id="{{question.option_selected}}"]').prop("checked", true);
    $('span[id="{{question.option_selected}}"]').html('wrong answer');
}
$("#quizsubmit").on('click',function(){
    var answer=$('input[name="questionradio"]:checked').val();
    if(answer){
    $('#error').html('');
    $("#quizsubmit").html("submittining...");
    $('span[name="questionspan"]').html("");
    $.ajax({
        url : "/quiz_submit/", // the endpoint
        type : "POST", // http method
        data : { code:"{{question.code}}",
                answer:$('input[name="questionradio"]:checked').val()}, // data sent with the post request
    // handle a successful response
        success : function(json) {
        if(json['status']){
            $("span[id="+answer+"]").html('correct answer');
            $('#status').html('<i class="fa fa-check"></i>');
            $('input[name="questionradio"]').attr("disabled",true);
            $('#quizsubmit').removeClass("btn-primary");
            $('#quizsubmit').addClass("btn-success disabled");
            $('#quizsubmit').html("Accepted");
        }
        else{
            $("span[id="+answer+"]").html('wrong answer');
            $('#status').html('<i class="fa fa-remove"></i>');
            $("#quizsubmit").html("Submit");
        }
    },

    // handle a non-successful response
    error : function(xhr,errmsg,err) {
        alert(response["responseJSON"]["error"]);
    }
    });
    }
    else{
    $('#error').html("please select an option");
    }
});
});
    </script>
  </body>
</html>